import{p as Z,O as ie,y as J,E as te,P as re,i as ne,Q as se,a as r,K as L,G as oe,o as b,c as y,w as n,n as B,F as R,u as _,r as k,d as c,b as h,t as v,g as A,f as le,R as N,h as ue,M as de,N as ce}from"./index-9ba3883d.js";import{V as he,D as me,c as D,g as T,a as fe,q as V,h as p,f as I,e as O}from"./VLayout-adda45de.js";import{L as w}from"./leaflet.draw-src-43f32a12.js";import{c as pe,e as be,h as P,j as ge,k as Ee,l as ve,m as De,n as Se,o as ye,p as Ve,q as we,f as Fe,s as Re,g as Ie}from"./connectionManager-2eeae4e5.js";import{d as K,m as Ce,_ as He,e as U}from"./index-729d7a69.js";import{V as ke}from"./VMain-ee8a0062.js";import{V as S,a as g}from"./VRow-f18ab1bf.js";import{m as Ae,a as j,V as q}from"./VSelect-586de474.js";import{V as $}from"./VDialog-e9c9ca24.js";import{m as Te,u as $e,V as W,a as Me,c as ze,f as Ue}from"./VField-0d46687c.js";import{V as E}from"./VTextField-1fb5a8e2.js";import"./VList-88c86c8f.js";import"./VOverlay-0623f727.js";import"./scopeId-6d8fa96d.js";const qe=Z({...Te(),...ie(Ae(),["inline"])},"VCheckbox"),Le=J()({name:"VCheckbox",inheritAttrs:!1,props:qe(),emits:{"update:modelValue":i=>!0,"update:focused":i=>!0},setup(i,e){let{attrs:a,slots:t}=e;const s=te(i,"modelValue"),{isFocused:o,focus:l,blur:u}=$e(i),d=re(),m=ne(()=>i.id||`checkbox-${d}`);return K(()=>{const[f,F]=se(a),M=W.filterProps(i),H=j.filterProps(i);return r(W,L({class:["v-checkbox",i.class]},f,M,{modelValue:s.value,"onUpdate:modelValue":z=>s.value=z,id:m.value,focused:o.value,style:i.style}),{...t,default:z=>{let{id:Q,messagesId:Y,isDisabled:X,isReadonly:x,isValid:ee}=z;return r(j,L(H,{id:Q.value,"aria-describedby":Y.value,disabled:X.value,readonly:x.value},F,{error:ee.value===!1,modelValue:s.value,"onUpdate:modelValue":ae=>s.value=ae,onFocus:l,onBlur:u}),t)}})}),{}}});const Be=Z({...Ce(),...Me()},"VForm"),G=J()({name:"VForm",props:Be(),emits:{"update:modelValue":i=>!0,submit:i=>!0},setup(i,e){let{slots:a,emit:t}=e;const s=ze(i),o=oe();function l(d){d.preventDefault(),s.reset()}function u(d){const m=d,f=s.validate();m.then=f.then.bind(f),m.catch=f.catch.bind(f),m.finally=f.finally.bind(f),t("submit",m),m.defaultPrevented||f.then(F=>{var H;let{valid:M}=F;M&&((H=o.value)==null||H.submit())}),m.preventDefault()}return K(()=>{var d;return r("form",{ref:o,class:["v-form",i.class],style:i.style,novalidate:!0,onReset:l,onSubmit:u},[(d=a.default)==null?void 0:d.call(a,s)])}),Ue(s,o)}}),C=i=>(de("data-v-821b7ebb"),i=i(),ce(),i),_e=C(()=>h("h3",{style:{"margin-left":"15px",color:"white"}},"Submarins Disponibles",-1)),Ne={class:"d-flex align-center"},Oe=C(()=>h("div",{id:"mapaSelect",style:{height:"700px",width:"850px"}},null,-1)),Pe={style:{"margin-top":"25px"},class:"text-center"},je=C(()=>h("h3",{style:{"margin-left":"15px"}},"Rutines del submarí",-1)),We={class:"d-flex justify-space-between align-center p-2"},Ge={style:{margin:"20px"}},Ze=C(()=>h("h3",{style:{"margin-left":"15px"}},"Editar rutina",-1)),Je={style:{"margin-left":"15px"}},Ke=C(()=>h("h3",null,"Rutines",-1)),Qe=["checked","onClick","disabled"],Ye={style:{"margin-left":"5px"}},Xe={data(){return{isSearchActive:!1,drawer:!1,submarinoSeleccionado:null,dialogoSubmarinoVisible:!1,showAlert:!1,errorMessage:"",selectedArea:null,areas:[],submarinosAsignados:[],submarinosDisponibles:[],dialogRutina:!1,selectedRutina:null,selectedDate:null,nuevaRutina:"",nuevaTarea:{nombre:"",descripcion:"",diaInicio:null,horaInicio:null,diaFin:null,horaFin:null,submarinos:[]},nuevaHoraFin:null,hacerRutinas:[],descripciones:[],dias:[],nuevaDescripcion:"",rutinas:"",newRutina:[],editingTaskIndex:null,rutinaEnEdicion:{id:null,nombre:"",descripcion:"",selectedDate:null,horaInicio:null,horaFin:null,repetir:""},submarinos:[],editingTaskIndex:null,showDialogEdicion:!1,mapa:null,nombreLugarBusqueda:"",nuevoNombreLugar:"",areaEncontrada:null,areaEncontradaID:null,mapaInicializado:!1,repetirOpciones:["No repetir","Diariamente","Semanalmente","Mensualmente"],nuevaHoraInicio:"",nuevaRepetir:null,mostrarColumnaDerecha:!1,dialogTarea:!1,showDialogEdicionTarea:!1,minDate:new Date().toISOString().substr(0,10),seleccionSubmarinos:{},backgroundColor:"#EFEFEF"}},methods:{validarSolapamientos(i,e){const a=this.rutinas.rutinas.filter(s=>s.submarinos.includes(e)),t=this.generarRepeticionesTotales(i);for(const s of t)for(const o of a){if(i.id===o.id)continue;const l=this.generarRepeticionesTotales(o);for(const u of l){const d=s.fechaHoraInicio.getTime(),m=s.fechaHoraFin.getTime(),f=u.fechaHoraInicio.getTime(),F=u.fechaHoraFin.getTime();if(!(d>=F||m<=f))return alert(`Solapament detectat entre ${i.nombre} i ${o.nombre}`),!1}}return!0},generarRepeticionesTotales(i){return i.tipo==="Tarea"?this.generarRepeticionesDiarias(i):this.generarRepeticiones(i,i.repetir||"No repetir")},generarRepeticiones(i,e){let a=[],t=new Date(i.fechaHoraInicio),s=new Date(i.fechaHoraFin);if(e==="No repetir")a.push({fechaHoraInicio:t,fechaHoraFin:s});else{let o=s.getTime()-t.getTime();switch(e){case"Diariamente":for(let l=0;l<365;l++){let u=new Date(t.getTime()+l*864e5),d=new Date(u.getTime()+o);a.push({fechaHoraInicio:u,fechaHoraFin:d})}break;case"Semanalmente":for(let l=0;l<52;l++){let u=new Date(t.getTime()+l*6048e5),d=new Date(u.getTime()+o);a.push({fechaHoraInicio:u,fechaHoraFin:d})}break;case"Mensualmente":for(let l=0;l<12;l++){let u=new Date(t.getFullYear(),t.getMonth()+l,t.getDate(),t.getHours(),t.getMinutes()),d=new Date(u.getTime()+o);a.push({fechaHoraInicio:u,fechaHoraFin:d})}break}}return a},generarRepeticionesDiarias(i){let e=[],a=new Date(i.fechaHoraInicio),t=new Date(i.fechaHoraFin);for(;a<=t;){let s=new Date(a);s.setHours(t.getHours(),t.getMinutes(),t.getSeconds()),e.push({fechaHoraInicio:new Date(a),fechaHoraFin:s}),a.setDate(a.getDate()+1)}return e},toggleAsignacionRutina(i,e,a){if(a.preventDefault(),!this.estaRutinaAsignada(i,e))confirm("Voleu assignar aquesta rutina al submarí?")&&(this.validarSolapamientos(i,e.id_sub)?(i.submarinos.push(e.id_sub),this.actualizarBaseDeDatosRutina(i,e),setTimeout(()=>{a.target.checked=!0},0)):alert("L'assignació de la rutina es solapa amb altres activitats o no respecta l'interval de descans requerit."));else if(confirm("Vols desvincular aquesta rutina del submarí?")){const s=i.submarinos.indexOf(e.id_sub);i.submarinos.splice(s,1),this.actualizarBaseDeDatosRutinaEliminar(i,e),setTimeout(()=>{a.target.checked=!1},0)}this.$forceUpdate()},async actualizarBaseDeDatosRutina(i,e){await pe(this.areaEncontradaID,i.id,e.id_sub),await be(this.areaEncontradaID,i.id,e.id_sub)},async actualizarBaseDeDatosRutinaEliminar(i,e){await P(this.areaEncontradaID,i.id,e.id_sub),await ge(this.areaEncontradaID,i.id,e.id_sub)},async actualizarBaseDeDatosRutinaEliminarAlEliminarSub(i,e){await P(this.areaEncontradaID,i.id,e.id_sub)},actualizarDisponibilidad(i){if(!this.rutinas||!this.rutinas.rutinas){console.error("No se ha inicializado correctamente la lista de rutinas");return}const e=this.rutinas.rutinas.filter(a=>a.submarinos.includes(i));this.rutinas.rutinas.forEach(a=>{a.disponible=!0;for(let t of e)if(a.id!==t.id&&!this.validarSolapamientos(a,t)){a.disponible=!1;break}})},estaRutinaAsignada(i,e){return i.submarinos.includes(e.id_sub)},actualizarSubmarinos(){if(!this.areaEncontrada){this.submarinosAsignados=[],this.submarinosDisponibles=[];return}this.submarinosAsignados=this.submarinosAsignados.filter(i=>i.id_area===this.areaEncontrada._id),this.submarinosDisponibles=this.submarinosDisponibles.filter(i=>i.id_area!==this.areaEncontrada._id)},async asignarSubmarinos(){if(!this.areaEncontrada||!this.areaEncontrada._id){alert("Heu de seleccionar una àrea abans de poder afegir submarins.");return}const i=this.submarinosDisponibles.filter(a=>a.selected);this.submarinosDisponibles.forEach(a=>a.selected=!1);let e=[];for(let a of i)if(!this.submarinosAsignados.some(t=>t.id_sub===a.id_sub)){a.id_area=this.areaEncontrada._id,e.push(a);try{await Ee(this.areaEncontrada._id,a.id_sub)}catch(t){console.error("Error al actualizar submarinos:",t)}}this.submarinosAsignados=this.submarinosAsignados.filter(a=>a.id_area===this.areaEncontrada._id).concat(e),this.submarinosDisponibles=this.submarinosDisponibles.filter(a=>!a.id_area);try{await ve(this.areaEncontrada._id,this.submarinosAsignados)}catch(a){console.error("Error al actualizar submarinos en el backend:",a)}},cerrarDialogRutina(){this.dialogRutina=!1,this.selectedDate=null,this.selectRutinas()},async desvincularSubmarino(i){if(confirm("Estàs segur que vols desvincular el submarí?")){i.area=null,this.submarinosAsignados=this.submarinosAsignados.filter(e=>e!==i),this.submarinosDisponibles.push(i);try{this.rutinas.rutinas.forEach(e=>{const a=e.submarinos.indexOf(i.id_sub);a!==-1&&(e.submarinos.splice(a,1),this.actualizarBaseDeDatosRutinaEliminarAlEliminarSub(e,i))}),await De(this.areaEncontrada._id,i.id_sub),await Se(i.id_sub)}catch(e){console.error("Error al desvincular el submarino:",e)}this.getSubmarino()}else console.log("Desvinculación cancelada.")},crearRutina(){this.dialogRutina=!0},async agregarRutina(){const i=this.validarFecha(this.selectedDate),e=this.validarHora(this.nuevaHoraInicio),a=this.validarHoraFin(this.selectedDate,this.nuevaHoraInicio,this.nuevaHoraFin);if(i&&e&&a===!0){if(this.editingTaskIndex!==null)this.actualizarRutinaEditada();else if(this.nuevaRutina.trim()!=="")try{this.hacerRutinas.push(this.nuevaRutina),this.descripciones.push(this.nuevaDescripcion);const t=new Date(this.selectedDate),s=this.nuevaHoraInicio.split(":");t.setHours(parseInt(s[0]),parseInt(s[1]),0,0),t.setMinutes(t.getMinutes()-t.getTimezoneOffset());const o=new Date(t),l=this.nuevaHoraFin.split(":");o.setHours(parseInt(l[0]),parseInt(l[1]),0,0),o.setMinutes(o.getMinutes()-o.getTimezoneOffset());const u=`T${o.getUTCHours().toString().padStart(2,"0")}:${o.getUTCMinutes().toString().padStart(2,"0")}:00.000Z`;this.newRutina={nombre:this.nuevaRutina,descripcion:this.nuevaDescripcion,fechaHoraInicio:t.toISOString(),repetir:this.nuevaRepetir,submarinos:this.submarinos,fechaHoraFin:u},await ye(this.areaEncontradaID,this.newRutina),this.nuevaRutina="",this.nuevaDescripcion="",this.nuevaHoraInicio="",this.nuevaHoraFin="",this.nuevaRepetir=null,this.newRutina={},this.selectedDate=null}catch(t){console.error("Error al agregar la rutina:",t),alert("No s'ha pogut afegir la rutina degut a un error intern.")}this.selectRutinas()}else console.error("Error en la validación: No se puede agregar la rutina debido a datos inválidos."),alert("Error en la validació: No es pot afegir la rutina a causa de dades invàlides.")},editarRutina(i){if(i>=0&&i<this.rutinas.rutinas.length){const e=this.rutinas.rutinas[i];this.rutinaEnEdicion.id=e.id,this.rutinaEnEdicion.nombre=e.nombre,this.rutinaEnEdicion.descripcion=e.descripcion||"";const a=new Date(e.fechaHoraInicio);if(this.rutinaEnEdicion.selectedDate=a.toISOString().split("T")[0],this.rutinaEnEdicion.horaInicio=`${a.getUTCHours().toString().padStart(2,"0")}:${a.getUTCMinutes().toString().padStart(2,"0")}`,e.fechaHoraFin&&e.fechaHoraFin.startsWith("T")){const t=e.fechaHoraFin.slice(1,-5),[s,o]=t.split(":");this.rutinaEnEdicion.horaFin=`${s}:${o}`}else this.rutinaEnEdicion.horaFin="";this.rutinaEnEdicion.repetir=e.repetir||null,this.editingTaskIndex=i,this.showDialogEdicion=!0}else console.error("Índice de rutina no válido:",i)},async actualizarRutinaEditada(){const i=this.validarFecha(this.rutinaEnEdicion.selectedDate),e=this.validarHoraEditar(this.rutinaEnEdicion.selectedDate,this.rutinaEnEdicion.horaInicio),a=this.validarHoraFin(this.rutinaEnEdicion.selectedDate,this.rutinaEnEdicion.horaInicio,this.rutinaEnEdicion.horaFin);if(i&&e&&a===!0)try{const t=new Date(this.rutinaEnEdicion.selectedDate),[s,o]=this.rutinaEnEdicion.horaInicio.split(":");t.setUTCHours(parseInt(s),parseInt(o),0,0);const[l,u]=this.rutinaEnEdicion.horaFin.split(":"),d=new Date(t);d.setUTCHours(parseInt(l),parseInt(u),0,0);const m=`T${d.getUTCHours().toString().padStart(2,"0")}:${d.getUTCMinutes().toString().padStart(2,"0")}:00.000Z`;await Ve(this.rutinaEnEdicion.nombre.trim(),this.rutinaEnEdicion.descripcion||"",t.toISOString(),m,this.rutinaEnEdicion.repetir,this.areaEncontradaID,this.rutinaEnEdicion.id),this.editingTaskIndex=null,this.rutinaEnEdicion={nombre:"",descripcion:"",fechaHoraInicio:null,horaInicio:"",horaFin:"",repetir:null},this.selectRutinas(),this.showDialogEdicion=!1}catch(t){console.error("Error al actualizar la rutina:",t)}},async confirmarEliminar(i){if(confirm("Estàs segur que vols eliminar aquesta rutina?"))try{const e=this.areaEncontradaID,a=this.rutinas.rutinas[i].id;await we(e,a),this.selectRutinas()}catch(e){console.error("Error al eliminar la rutina:",e)}},async getAreas(){try{const e=_().getUserEmpresa;this.areas=await Fe(),this.areas=this.areas.filter(a=>a.idEmpresa===e)}catch(i){console.error("Error fetching areas:",i)}},async buscarArea(){if(this.isSearchActive)this.limpiarBusqueda();else{const i=this.areas.find(e=>e.nombreArea===this.nombreLugarBusqueda);if(i&&i.coordenadas){this.mostrarColumnaDerecha=!0,this.rutinas=[],this.cargarCoordenadasEnMapaSelect(i.coordenadas),this.areaEncontrada=i,this.areaEncontradaID=i._id,this.nombreExistente=i.nombreArea;const e=this.submarinosDisponibles.filter(a=>a.id_area===this.areaEncontradaID);this.submarinosAsignados.push(...e),this.submarinosDisponibles=this.submarinosDisponibles.filter(a=>a.id_area!==this.areaEncontradaID),await this.selectRutinas(this.areaEncontradaID),this.isSearchActive=!0}else this.rutinas=[]}this.actualizarSubmarinos(),this.getSubmarino()},limpiarBusqueda(){this.areaEncontrada=null,this.nombreLugarBusqueda="",this.isSearchActive=!1,this.limpiarMapaSelect(),this.initMapaSelect(),this.mostrarColumnaDerecha=!1},async selectRutinas(){try{const i=await Re(this.areaEncontradaID);this.rutinas=i}catch(i){console.error("Error fetching rutinas:",i)}},async getSubmarino(){const e=_().getUserEmpresa;try{const a=await Ie(e);this.submarinosDisponibles=a.filter(t=>!t.id_area),this.submarinosAsignados=a.filter(t=>t.id_area)}catch(a){console.error("Error fetching submarinos:",a)}},initMapaSelect(){this.mapa=w.map("mapaSelect").setView([41.38879,2.15899],11),w.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/rastertiles/voyager/{z}/{x}/{y}.png",{maxZoom:18}).addTo(this.mapa);const i=new w.FeatureGroup;this.mapa.addLayer(i),this.drawControl=new w.Control.Draw({edit:{featureGroup:i,edit:!1,remove:!1},draw:{polygon:!1,circle:!1,rectangle:!1,marker:!1,polyline:!1,circlemarker:!1}}),this.mapa.addControl(this.drawControl),this.mapa.on(w.Draw.Event.CREATED,e=>{const a=e.layer;i.addLayer(a)})},cargarCoordenadasEnMapaSelect(i){this.limpiarMapaSelect(),this.initMapaSelect(),this.drawControl.addTo(this.mapa),this.dibujarAreaEnMapa(i)},dibujarAreaEnMapa(i){const e=w.geoJSON({type:"Feature",geometry:{type:"Polygon",coordinates:i}}).addTo(this.mapa);this.mapa.fitBounds(e.getBounds())},limpiarMapaSelect(){this.mapa&&(this.drawControl&&this.mapa.removeControl(this.drawControl),this.mapa.eachLayer(i=>{this.mapa.removeLayer(i)}),this.mapa.remove())},validarCampos(){let i=!0;return[{modelo:this.nuevaRutina,ref:"nombreRutina"},{modelo:this.selectedDate,ref:"fechaRutina"},{modelo:this.nuevaHoraInicio,ref:"horaInicioRutina"},{modelo:this.nuevaRepetir,ref:"repetirRutina"}].forEach(a=>{typeof a.modelo=="string"&&!a.modelo.trim()?(this.$refs[a.ref].$el.style.border="1px solid red",i=!1):a.modelo==null||a.modelo===""?(this.$refs[a.ref].$el.style.border="1px solid red",i=!1):this.$refs[a.ref].$el.style.border=""}),i||window.alert("Si us plau, ompliu tots els camps obligatoris."),i},validarCamposEditar(){let i=!0;return[{modelo:this.rutinaEnEdicion.nombre,ref:"nombreRutinaEditada"},{modelo:this.rutinaEnEdicion.selectedDate,ref:"diaRutinaEditada"},{modelo:this.rutinaEnEdicion.horaInicio,ref:"horaInicioRutinaEditada"},{modelo:this.rutinaEnEdicion.repetir,ref:"repetirRutinaEditada"}].forEach(a=>{if(!this.$refs[a.ref]){console.error(`Ref ${a.ref} not found`);return}typeof a.modelo=="string"&&!a.modelo.trim()?(this.$refs[a.ref].$el.style.border="1px solid red",i=!1):a.modelo==null||a.modelo===""?(this.$refs[a.ref].$el.style.border="1px solid red",i=!1):this.$refs[a.ref].$el.style.border=""}),i||window.alert("Si us plau, ompliu tots els camps obligatoris."),i},validarFecha(i){const e=new Date(this.minDate+"T00:00:00");return new Date(i+"T00:00:00")<e?(this.mostrarAlerta("La data ha de ser avui o en el futur"),!1):!0},validarHora(i){const e=new Date;if(new Date(this.selectedDate).toDateString()===e.toDateString()){const t=`${e.getHours()}:${e.getMinutes()}`;if(i<t)return this.mostrarAlerta("L'hora ha de ser al futur"),!1}return!0},validarHoraEditar(i,e){const a=new Date;if(new Date(i).toDateString()===a.toDateString()){const s=`${a.getHours()}:${a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes()}`;if(e<s)return this.mostrarAlerta("L'hora ha de ser al futur"),!1}return!0},validarFechaHoraActual(i,e){const a=new Date;return new Date(i+"T"+e)<a?(this.mostrarAlerta("La data i l'hora han de ser en el futur."),!1):!0},validarFechaHoraFin(i,e,a,t){const s=new Date(i+"T"+e),o=new Date(a+"T"+t);return o<=s?(this.mostrarAlerta("La data i l'hora de fi han de ser posteriors a la d'inici."),!1):o.getTime()-s.getTime()<36e5?(this.mostrarAlerta("L'hora de fi ha de ser com a mínim una hora després de l'hora d'inici."),!1):!0},mostrarAlerta(i){this.errorMessage=i,this.showAlert=!0},abrirDialogoSubmarino(i){this.submarinoSeleccionado=i,this.actualizarDisponibilidad(i.id_sub),this.dialogoSubmarinoVisible=!0},validarHoraFin(i,e,a){if(!e||!a)return"L'hora d'inici i l'hora final són requerides.";const t=e.split(":"),s=a.split(":");if(t.length<2||s.length<2)return"Format d'hora incorrecte.";const o=new Date(i);o.setHours(parseInt(t[0]),parseInt(t[1]),0);const l=new Date(i);l.setHours(parseInt(s[0]),parseInt(s[1]),0);const u=l-o;return u<0?"L'hora final no pot ser anterior a l'hora d'inici.":u/6e4<150?"L'hora de fi ha de ser com a mínim 2 hores i 30 minuts després de l'hora d'inici.":!0},detectScreenSize(){window.innerWidth<=768?this.backgroundColor="#EFEFEF":this.backgroundColor="#EFEFEF"}},computed:{submarinosAsignadosFiltrados(){return this.submarinosAsignados.filter(i=>i.id_area===this.areaEncontradaID)},actividadesAsignadas(){return[...this.rutinas.rutinas.filter(i=>i.submarinos.includes(this.submarinoSeleccionado.id))]}},created(){console.log("CREADO"),window.addEventListener("resize",this.detectScreenSize),this.detectScreenSize()},mounted(){console.log("MONTADO"),this.$nextTick(()=>{this.detectScreenSize()}),this.initMapaSelect(),this.getAreas(),this.getSubmarino()},updated(){console.log("UPDATED")},destroyed(){window.removeEventListener("resize",this.detectScreenSize)}},xe=Object.assign(Xe,{__name:"submarinos",setup(i){return(e,a)=>(b(),y(R,null,[r(me),r(he,{class:"rounded rounded-md",style:B({backgroundColor:e.backgroundColor,minHeight:"100vh"})},{default:n(()=>[r(ke,null,{default:n(()=>[r(S,{style:{margin:"25px"}},{default:n(()=>[r(g,{cols:"12",sm:"2"},{default:n(()=>[r(D,{style:{"max-width":"300px"}},{default:n(()=>[r(T,{height:"60",style:{"background-color":"#224870"}},{default:n(()=>[_e]),_:1}),r(fe,null,{default:n(()=>[r(S,null,{default:n(()=>[(b(!0),y(R,null,k(e.submarinosDisponibles,t=>(b(),A(g,{key:t.id_sub,cols:"12"},{default:n(()=>[r(Le,{modelValue:t.selected,"onUpdate:modelValue":s=>t.selected=s,label:t.nom_sub},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024))),128))]),_:1})]),_:1}),r(V,{class:"d-flex justify-center"},{default:n(()=>[r(p,{onClick:e.asignarSubmarinos,style:{"background-color":"#84ACCE",color:"white"}},{default:n(()=>[c("Afegir Submarins")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),r(g,{cols:"12",sm:"6"},{default:n(()=>[h("div",Ne,[r(q,{style:{height:"75px","font-size":"auto",color:"#224870"},modelValue:e.nombreLugarBusqueda,"onUpdate:modelValue":a[0]||(a[0]=t=>e.nombreLugarBusqueda=t),items:e.areas.map(t=>t.nombreArea),label:"Seleccionar àrea",onChange:e.actualizarSubmarinos,disabled:e.isSearchActive},null,8,["modelValue","items","onChange","disabled"]),r(p,{class:"ml-4 elevation-2",onClick:e.buscarArea,disabled:e.nombreLugarBusqueda===""&&!e.isSearchActive,style:B({backgroundColor:e.isSearchActive?"red":"#84ACCE",color:"white"})},{default:n(()=>[c(v(e.isSearchActive?"Netejar àrea seleccionada":"Buscar àrea"),1)]),_:1},8,["onClick","disabled","style"])]),Oe]),_:1}),r(g,{cols:"12",sm:"4"},{default:n(()=>[e.mostrarColumnaDerecha?(b(),A(S,{key:0},{default:n(()=>[r(g,{class:"text-center"},{default:n(()=>[r(p,{style:{"background-color":"#84ACCE",color:"white"},onClick:e.crearRutina},{default:n(()=>[c("Activitats dels submarins")]),_:1},8,["onClick"]),h("h3",Pe,"Submarins assignats a "+v(e.nombreLugarBusqueda),1),r(S,{style:{"margin-top":"10px"}},{default:n(()=>[(b(!0),y(R,null,k(e.submarinosAsignadosFiltrados,t=>(b(),A(g,{cols:"12",key:t.id_sub,class:"justify-center align-center"},{default:n(()=>[r(D,{style:{"max-width":"500px","max-height":"200px",margin:"10px"},class:ue({"estado-desactivado":t.estado_sub.trim().toLowerCase()==="desactivado","estado-activo":t.estado_sub.trim().toLowerCase()!=="desactivado"})},{default:n(()=>[r(O,{class:"text-center"},{default:n(()=>[c(v(t.nom_sub),1)]),_:2},1024),r(I,{class:"text-left"},{default:n(()=>[h("p",null,"Estat: "+v(t.estado_sub),1),h("p",null,"Ubicació: "+v(t.ruta),1)]),_:2},1024),r(V,{class:"justify-center",style:{"margin-top":"-25px"}},{default:n(()=>[r(p,{style:{"background-color":"#84ACCE",color:"white"},onClick:s=>e.abrirDialogoSubmarino(t)},{default:n(()=>[c("Veure tasques i rutines")]),_:2},1032,["onClick"]),r(p,{color:"red",icon:"",onClick:s=>e.desvincularSubmarino(t)},{default:n(()=>[r(U,null,{default:n(()=>[c("mdi-delete")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):le("",!0)]),_:1})]),_:1}),r($,{modelValue:e.dialogRutina,"onUpdate:modelValue":a[7]||(a[7]=t=>e.dialogRutina=t),"max-height":"855","max-width":"800"},{default:n(()=>[r(D,{height:"855",width:"800"},{default:n(()=>[r(T,{height:"60",style:{"background-color":"#224870",color:"white"}},{default:n(()=>[je]),_:1}),r(I,null,{default:n(()=>[r(S,null,{default:n(()=>[r(g,{cols:"6"},{default:n(()=>[r(G,{ref:"taskForm",onSubmit:N(e.agregarRutina,["prevent"])},{default:n(()=>[r(E,{ref:"nombreRutina",modelValue:e.nuevaRutina,"onUpdate:modelValue":a[1]||(a[1]=t=>e.nuevaRutina=t),label:"* Nombri la rutina"},null,8,["modelValue"]),r(E,{style:{height:"500px","margin-bottom":"-210px"},modelValue:e.nuevaDescripcion,"onUpdate:modelValue":a[2]||(a[2]=t=>e.nuevaDescripcion=t),label:"Descripció"},null,8,["modelValue"]),r(E,{ref:"fechaRutina",modelValue:e.selectedDate,"onUpdate:modelValue":a[3]||(a[3]=t=>e.selectedDate=t),label:"Dia d'inici",type:"date",rules:[()=>e.validarFecha(e.selectedDate)||"Fecha inválida"],required:""},null,8,["modelValue","rules"]),r(E,{ref:"horaInicioRutina",modelValue:e.nuevaHoraInicio,"onUpdate:modelValue":a[4]||(a[4]=t=>e.nuevaHoraInicio=t),label:"Hora d'inici",type:"time",rules:[()=>e.validarHora(e.nuevaHoraInicio)||"Hora inválida"],required:""},null,8,["modelValue","rules"]),r(E,{ref:"horaFinNuevaRutina",modelValue:e.nuevaHoraFin,"onUpdate:modelValue":a[5]||(a[5]=t=>e.nuevaHoraFin=t),label:"Hora de fi",type:"time",rules:[()=>e.validarHoraFin(e.selectedDate,e.nuevaHoraInicio,e.nuevaHoraFin)||"Hora inválida"],required:""},null,8,["modelValue","rules"]),r(q,{ref:"repetirRutina",modelValue:e.nuevaRepetir,"onUpdate:modelValue":a[6]||(a[6]=t=>e.nuevaRepetir=t),items:e.repetirOpciones,label:"Repetir",required:""},null,8,["modelValue","items"]),r(p,{onClick:e.agregarRutina,style:{"background-color":"#84ACCE",color:"white"}},{default:n(()=>[c("Afegeix rutina")]),_:1},8,["onClick"])]),_:1},8,["onSubmit"])]),_:1}),r(g,{cols:"6"},{default:n(()=>[r(S,null,{default:n(()=>[(b(!0),y(R,null,k(e.rutinas.rutinas,(t,s)=>(b(),A(g,{key:s,cols:"12"},{default:n(()=>[r(D,null,{default:n(()=>[h("div",We,[h("h3",Ge,v(t.nombre),1),h("div",null,[r(U,{onClick:o=>e.editarRutina(s)},{default:n(()=>[c("mdi-pencil")]),_:2},1032,["onClick"]),r(U,{onClick:o=>e.confirmarEliminar(s),style:{"margin-left":"10px","margin-right":"10px",color:"red"}},{default:n(()=>[c("mdi-delete")]),_:2},1032,["onClick"])])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),r(V,null,{default:n(()=>[r(p,{onClick:e.cerrarDialogRutina,style:{color:"red"}},{default:n(()=>[c("Tancar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),r($,{modelValue:e.showDialogEdicion,"onUpdate:modelValue":a[17]||(a[17]=t=>e.showDialogEdicion=t),position:"center","max-width":"800"},{default:n(()=>[r(D,{height:"855",width:"800"},{default:n(()=>[r(T,{height:"60",style:{"background-color":"#224870",color:"white"}},{default:n(()=>[Ze]),_:1}),r(I,null,{default:n(()=>[r(G,{onSubmit:a[14]||(a[14]=N(t=>e.actualizarRutinaEditada(e.editingTaskIndex),["prevent"]))},{default:n(()=>[r(E,{ref:"nombreRutinaEditada",modelValue:e.rutinaEnEdicion.nombre,"onUpdate:modelValue":a[8]||(a[8]=t=>e.rutinaEnEdicion.nombre=t),label:"* Nom de la rutina",required:""},null,8,["modelValue"]),r(E,{style:{height:"500px","margin-bottom":"-210px"},modelValue:e.rutinaEnEdicion.descripcion,"onUpdate:modelValue":a[9]||(a[9]=t=>e.rutinaEnEdicion.descripcion=t),label:"Descripció"},null,8,["modelValue"]),r(E,{ref:"diaRutinaEditada",modelValue:e.rutinaEnEdicion.selectedDate,"onUpdate:modelValue":a[10]||(a[10]=t=>e.rutinaEnEdicion.selectedDate=t),label:"Dia d'inici",type:"date",rules:[()=>e.validarFecha(e.rutinaEnEdicion.selectedDate)||"Fecha inválida"],required:""},null,8,["modelValue","rules"]),r(E,{ref:"horaInicioRutinaEditada",modelValue:e.rutinaEnEdicion.horaInicio,"onUpdate:modelValue":a[11]||(a[11]=t=>e.rutinaEnEdicion.horaInicio=t),label:"Hora d'inici",type:"time",rules:[()=>e.validarHoraEditar(e.rutinaEnEdicion.selectedDate,e.rutinaEnEdicion.horaInicio)||"Hora inválida"],required:""},null,8,["modelValue","rules"]),r(E,{ref:"horaFinRutinaEditada",modelValue:e.rutinaEnEdicion.horaFin,"onUpdate:modelValue":a[12]||(a[12]=t=>e.rutinaEnEdicion.horaFin=t),label:"Hora de fi",type:"time",rules:[()=>e.validarHoraFin(e.rutinaEnEdicion.selectedDate,e.rutinaEnEdicion.horaInicio,e.rutinaEnEdicion.horaFin)||"Hora inválida"],required:""},null,8,["modelValue","rules"]),r(q,{ref:"repetirRutinaEditada",modelValue:e.rutinaEnEdicion.repetir,"onUpdate:modelValue":a[13]||(a[13]=t=>e.rutinaEnEdicion.repetir=t),items:e.repetirOpciones,label:"Repetir",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),r(V,null,{default:n(()=>[r(p,{style:{"background-color":"#84ACCE",color:"white"},onClick:a[15]||(a[15]=t=>e.actualizarRutinaEditada(e.editingTaskIndex))},{default:n(()=>[c("Actualitzar rutina")]),_:1}),r(p,{style:{color:"red"},onClick:a[16]||(a[16]=t=>this.showDialogEdicion=!1)},{default:n(()=>[c("Cancelar")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),r($,{modelValue:e.showAlert,"onUpdate:modelValue":a[19]||(a[19]=t=>e.showAlert=t),persistent:"","max-height":"400","max-width":"400"},{default:n(()=>[r(D,null,{default:n(()=>[r(O,null,{default:n(()=>[c("Error de validación")]),_:1}),r(I,null,{default:n(()=>[c(v(e.errorMessage),1)]),_:1}),r(V,null,{default:n(()=>[r(p,{color:"primary",text:"",onClick:a[18]||(a[18]=t=>e.showAlert=!1)},{default:n(()=>[c("Acceptar")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),r($,{modelValue:e.dialogoSubmarinoVisible,"onUpdate:modelValue":a[21]||(a[21]=t=>e.dialogoSubmarinoVisible=t),"max-width":"1000px"},{default:n(()=>[r(D,null,{default:n(()=>[r(T,{height:"60",style:{"background-color":"#224870",color:"white"}},{default:n(()=>[h("h3",Je,v(e.submarinoSeleccionado.nom_sub),1)]),_:1}),r(I,null,{default:n(()=>[r(S,null,{default:n(()=>[r(g,{cols:"6"},{default:n(()=>[Ke,(b(!0),y(R,null,k(e.rutinas.rutinas,t=>(b(),y("div",{key:t.id,style:{margin:"10px"},class:"my-2"},[h("input",{type:"checkbox",class:"checkbox-personalizado",checked:e.estaRutinaAsignada(t,e.submarinoSeleccionado),onClick:s=>e.toggleAsignacionRutina(t,e.submarinoSeleccionado,s),disabled:!t.disponible},null,8,Qe),h("label",Ye,v(`${t.nombre} - ${t.repetir}`),1)]))),128))]),_:1})]),_:1})]),_:1}),r(V,null,{default:n(()=>[r(p,{color:"red",onClick:a[20]||(a[20]=t=>e.dialogoSubmarinoVisible=!1)},{default:n(()=>[c("Tancar")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["style"])],64))}}),fa=He(xe,[["__scopeId","data-v-821b7ebb"]]);export{fa as default};
